{% extends 'base.html' %}
{% load static %}
{% load filename_extras %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">Upload PDF to Create Audiobook</h1>
    
    <!-- Display Messages -->
    {% if messages %}
        <div class="mb-4">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}
    
    <!-- PDF Upload Form -->
    <div class="card mb-5">
        <div class="card-header">
            Upload a PDF
        </div>
        <div class="card-body">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="btn btn-primary">Upload PDF</button>
            </form>
        </div>
    </div>
    
    <!-- User's Uploaded PDFs and Audiobooks -->
    <h2>Your Uploaded PDFs and Audiobooks</h2>
    {% if user_pdfs.exists %}
        <div class="list-group">
            {% for pdf in user_pdfs %}
                <div class="list-group-item">
                    <h5>{{ pdf.pdf.name|basename }}</h5>
                    <p>Uploaded at: {{ pdf.uploaded_at }}</p>
                    {% if pdf.audio %}
                        <p>Audio generated at: {{ pdf.audio_generated_at }}</p>
                        <audio controls>
                            <source src="{{ pdf.audio.url }}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                    {% else %}
                        <p>Audio not yet generated.</p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>You have not uploaded any PDFs yet.</p>
    {% endif %}
</div>
{% endblock %} 